<!-- templates/posts/list.html -->
{% extends "base.html" %}
{% block title %}All Posts - ConnectSphere{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <div class="flex justify-between items-center mb-8">
        <h1 class="text-4xl font-bold text-indigo-600">Community Feed</h1>
        <a href="{% url 'create_post' %}" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-8 rounded-full shadow-lg transition transform hover:scale-105">
            <i class="fas fa-plus mr-2"></i> New Post
        </a>
    </div>

    {% for post in posts %}
    <div class="bg-white rounded-xl shadow-lg p-6 mb-6 border-l-4 {% if post.is_important %}border-red-500{% else %}border-gray-200{% endif %}">
        <div class="flex items-center mb-4">
            <img src="{{ post.author.profile.avatar.url }}" class="w-12 h-12 rounded-full mr-4">
            <div>
                <strong class="text-lg">{{ post.author.username }}</strong>
                <p class="text-gray-500 text-sm">{{ post.created_at|timesince }} ago</p>
            </div>
            {% if post.is_important %}
                <span class="ml-auto bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-bold">IMPORTANT</span>
            {% endif %}
        </div>

        <p class="text-gray-800 text-lg mb-4">{{ post.content|linebreaks }}</p>

        {% if post.image %}
            <img src="{{ post.image.url }}" class="rounded-lg max-h-96 w-full object-cover mb-4 shadow">
        {% endif %}

        {% if post.file %}
            <div class="bg-green-50 border-2 border-green-300 rounded-lg p-4 inline-block">
                <p class="font-bold text-green-800">File Attached (Scanned & Safe)</p>
                <a href="{{ post.file.url }}" class="text-green-600 hover:underline font-bold" download>
                    Download {{ post.file.name|slice:"-30:" }}
                </a>
            </div>
        {% endif %}

        <div class="mt-4 flex space-x-6 text-gray-600">
            <a href="#" class="hover:text-indigo-600 font-bold">Like ({{ post.likes.count }})</a>
            <a href="{% url 'post_detail' post.id %}" class="hover:text-indigo-600 font-bold">Comments</a>
        </div>
    </div>
    {% empty %}
        <p class="text-center text-gray-500 text-2xl mt-20">No posts yet. Be the first to post!</p>
    {% endfor %}
</div>
{% endblock %}